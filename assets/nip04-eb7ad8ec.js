import{b as y,s as f,r as b,c as u,a as r}from"./index-22237bbc.js";var x=new TextDecoder("utf-8"),m=new TextEncoder;function A(e,n,c){const i=e instanceof Uint8Array?y(e):e,o=f.getSharedSecret(i,"02"+n),a=v(o);let t=Uint8Array.from(b(16)),d=m.encode(c),l=u(a,t).encrypt(d),p=r.encode(new Uint8Array(l)),s=r.encode(new Uint8Array(t.buffer));return`${p}?iv=${s}`}function U(e,n,c){const i=e instanceof Uint8Array?y(e):e;let[o,a]=c.split("?iv="),t=f.getSharedSecret(i,"02"+n),d=v(t),l=r.decode(a),p=r.decode(o),s=u(d,l).decrypt(p);return x.decode(s)}function v(e){return e.slice(1,33)}export{U as decrypt,A as encrypt};
